{"ast":null,"code":"/*eslint-disable */\nvar isSupported = typeof navigator !== 'undefined' && 'serviceWorker' in navigator;\nfunction waitForServiceWorker() {\n  return new Promise(function (resolve, reject) {\n    if (!isSupported) {\n      reject(new Error('Unsupported'));\n    } else if (navigator.serviceWorker.controller) {\n      // A serviceWorker is already registered and active.\n      resolve();\n    } else {\n      navigator.serviceWorker.addEventListener('controllerchange', function () {\n        resolve();\n      });\n    }\n  });\n}\nvar ServiceWorkerStore = /*#__PURE__*/function () {\n  function ServiceWorkerStore(opts) {\n    this.ready = waitForServiceWorker();\n    this.name = opts.storeName;\n  }\n  var _proto = ServiceWorkerStore.prototype;\n  _proto.list = function list() {\n    var _this = this;\n    var defer = {};\n    var promise = new Promise(function (resolve, reject) {\n      defer.resolve = resolve;\n      defer.reject = reject;\n    });\n    console.log('Loading stored blobs from Service Worker');\n    var onMessage = function onMessage(event) {\n      if (event.data.store !== _this.name) {\n        return;\n      }\n      switch (event.data.type) {\n        case 'uppy/ALL_FILES':\n          defer.resolve(event.data.files);\n          navigator.serviceWorker.removeEventListener('message', onMessage);\n          break;\n      }\n    };\n    this.ready.then(function () {\n      navigator.serviceWorker.addEventListener('message', onMessage);\n      navigator.serviceWorker.controller.postMessage({\n        type: 'uppy/GET_FILES',\n        store: _this.name\n      });\n    });\n    return promise;\n  };\n  _proto.put = function put(file) {\n    var _this2 = this;\n    return this.ready.then(function () {\n      navigator.serviceWorker.controller.postMessage({\n        type: 'uppy/ADD_FILE',\n        store: _this2.name,\n        file: file\n      });\n    });\n  };\n  _proto.delete = function _delete(fileID) {\n    var _this3 = this;\n    return this.ready.then(function () {\n      navigator.serviceWorker.controller.postMessage({\n        type: 'uppy/REMOVE_FILE',\n        store: _this3.name,\n        fileID: fileID\n      });\n    });\n  };\n  return ServiceWorkerStore;\n}();\nServiceWorkerStore.isSupported = isSupported;\nmodule.exports = ServiceWorkerStore;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}