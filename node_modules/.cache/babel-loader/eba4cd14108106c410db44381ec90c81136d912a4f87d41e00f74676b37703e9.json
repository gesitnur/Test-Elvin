{"ast":null,"code":"function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nvar Cropper = require('cropperjs');\nvar _require = require('preact'),\n  h = _require.h,\n  Component = _require.Component;\nmodule.exports = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(Editor, _Component);\n  function Editor(props) {\n    var _this;\n    _this = _Component.call(this, props) || this;\n    _this.granularRotateOnChange = function (ev) {\n      var _this$state = _this.state,\n        rotationAngle = _this$state.rotationAngle,\n        rotationDelta = _this$state.rotationDelta;\n      var pendingRotationDelta = Number(ev.target.value) - rotationDelta;\n      cancelAnimationFrame(_this.granularRotateOnInputNextFrame);\n      if (pendingRotationDelta !== 0) {\n        var pendingRotationAngle = rotationAngle + pendingRotationDelta;\n        _this.granularRotateOnInputNextFrame = requestAnimationFrame(function () {\n          _this.cropper.rotateTo(pendingRotationAngle);\n        });\n      }\n    };\n    _this.state = {\n      rotationAngle: 0,\n      rotationDelta: 0\n    };\n    return _this;\n  }\n  var _proto = Editor.prototype;\n  _proto.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n    var _this$props = this.props,\n      opts = _this$props.opts,\n      storeCropperInstance = _this$props.storeCropperInstance;\n    this.cropper = new Cropper(this.imgElement, opts.cropperOptions);\n    storeCropperInstance(this.cropper);\n    if (opts.actions.granularRotate) {\n      this.imgElement.addEventListener('crop', function (ev) {\n        var rotationAngle = ev.detail.rotate;\n        _this2.setState({\n          rotationAngle: rotationAngle,\n          // 405 == 360 + 45\n          rotationDelta: (rotationAngle + 405) % 90 - 45\n        });\n      });\n    }\n  };\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.cropper.destroy();\n  };\n  _proto.renderRevert = function renderRevert() {\n    var _this3 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('revert'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        _this3.cropper.reset();\n        _this3.cropper.setAspectRatio(0);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M0 0h24v24H0z\",\n      fill: \"none\"\n    }), h(\"path\", {\n      d: \"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\"\n    })));\n  };\n  _proto.renderRotate = function renderRotate() {\n    var _this4 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      onClick: function onClick() {\n        return _this4.cropper.rotate(-90);\n      },\n      \"aria-label\": this.props.i18n('rotate'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\"\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M0 0h24v24H0V0zm0 0h24v24H0V0z\",\n      fill: \"none\"\n    }), h(\"path\", {\n      d: \"M14 10a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2v-7a2 2 0 012-2h8zm0 1.75H6a.25.25 0 00-.243.193L5.75 12v7a.25.25 0 00.193.243L6 19.25h8a.25.25 0 00.243-.193L14.25 19v-7a.25.25 0 00-.193-.243L14 11.75zM12 .76V4c2.3 0 4.61.88 6.36 2.64a8.95 8.95 0 012.634 6.025L21 13a1 1 0 01-1.993.117L19 13h-.003a6.979 6.979 0 00-2.047-4.95 6.97 6.97 0 00-4.652-2.044L12 6v3.24L7.76 5 12 .76z\"\n    })));\n  };\n  _proto.renderGranularRotate = function renderGranularRotate() {\n    return h(\"label\", {\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      \"aria-label\": this.state.rotationAngle + \"\\xBA\",\n      className: \"uppy-ImageCropper-rangeWrapper uppy-u-reset\"\n    }, h(\"input\", {\n      className: \"uppy-ImageCropper-range uppy-u-reset\",\n      type: \"range\",\n      onInput: this.granularRotateOnChange,\n      onChange: this.granularRotateOnChange,\n      value: this.state.rotationDelta,\n      min: \"-45\",\n      max: \"44\",\n      \"aria-label\": this.props.i18n('rotate')\n    }));\n  };\n  _proto.renderFlip = function renderFlip() {\n    var _this5 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('flipHorizontal'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        return _this5.cropper.scaleX(-_this5.cropper.getData().scaleX || -1);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M0 0h24v24H0z\",\n      fill: \"none\"\n    }), h(\"path\", {\n      d: \"M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z\"\n    })));\n  };\n  _proto.renderZoomIn = function renderZoomIn() {\n    var _this6 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('zoomIn'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        return _this6.cropper.zoom(0.1);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\",\n      width: \"24\"\n    }, h(\"path\", {\n      d: \"M0 0h24v24H0V0z\",\n      fill: \"none\"\n    }), h(\"path\", {\n      d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"\n    }), h(\"path\", {\n      d: \"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\"\n    })));\n  };\n  _proto.renderZoomOut = function renderZoomOut() {\n    var _this7 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('zoomOut'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        return _this7.cropper.zoom(-0.1);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M0 0h24v24H0V0z\",\n      fill: \"none\"\n    }), h(\"path\", {\n      d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z\"\n    })));\n  };\n  _proto.renderCropSquare = function renderCropSquare() {\n    var _this8 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('aspectRatioSquare'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        return _this8.cropper.setAspectRatio(1);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M0 0h24v24H0z\",\n      fill: \"none\"\n    }), h(\"path\", {\n      d: \"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\"\n    })));\n  };\n  _proto.renderCropWidescreen = function renderCropWidescreen() {\n    var _this9 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('aspectRatioLandscape'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        return _this9.cropper.setAspectRatio(16 / 9);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M 19,4.9999992 V 17.000001 H 4.9999998 V 6.9999992 H 19 m 0,-2 H 4.9999998 c -1.0999999,0 -1.9999999,0.9000001 -1.9999999,2 V 17.000001 c 0,1.1 0.9,2 1.9999999,2 H 19 c 1.1,0 2,-0.9 2,-2 V 6.9999992 c 0,-1.0999999 -0.9,-2 -2,-2 z\"\n    }), h(\"path\", {\n      fill: \"none\",\n      d: \"M0 0h24v24H0z\"\n    })));\n  };\n  _proto.renderCropWidescreenVertical = function renderCropWidescreenVertical() {\n    var _this10 = this;\n    return h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn\",\n      \"aria-label\": this.props.i18n('aspectRatioPortrait'),\n      \"data-microtip-position\": \"top\",\n      role: \"tooltip\",\n      onClick: function onClick() {\n        return _this10.cropper.setAspectRatio(9 / 16);\n      }\n    }, h(\"svg\", {\n      \"aria-hidden\": \"true\",\n      className: \"uppy-c-icon\",\n      width: \"24\",\n      height: \"24\",\n      viewBox: \"0 0 24 24\"\n    }, h(\"path\", {\n      d: \"M 19.000001,19 H 6.999999 V 5 h 10.000002 v 14 m 2,0 V 5 c 0,-1.0999999 -0.9,-1.9999999 -2,-1.9999999 H 6.999999 c -1.1,0 -2,0.9 -2,1.9999999 v 14 c 0,1.1 0.9,2 2,2 h 10.000002 c 1.1,0 2,-0.9 2,-2 z\"\n    }), h(\"path\", {\n      d: \"M0 0h24v24H0z\",\n      fill: \"none\"\n    })));\n  };\n  _proto.render = function render() {\n    var _this11 = this;\n    var _this$props2 = this.props,\n      currentImage = _this$props2.currentImage,\n      i18n = _this$props2.i18n,\n      opts = _this$props2.opts;\n    var actions = opts.actions; // eslint-disable-next-line compat/compat\n\n    var imageURL = URL.createObjectURL(currentImage.data);\n    return h(\"div\", {\n      className: \"uppy-ImageCropper\"\n    }, h(\"div\", {\n      className: \"uppy-ImageCropper-container\"\n    }, h(\"img\", {\n      className: \"uppy-ImageCropper-image\",\n      alt: currentImage.name,\n      src: imageURL,\n      ref: function ref(_ref) {\n        _this11.imgElement = _ref;\n      }\n    })), h(\"div\", {\n      className: \"uppy-ImageCropper-controls\"\n    }, actions.revert && this.renderRevert(), actions.rotate && this.renderRotate(), actions.granularRotate && this.renderGranularRotate(), actions.flip && this.renderFlip(), actions.zoomIn && this.renderZoomIn(), actions.zoomOut && this.renderZoomOut(), actions.cropSquare && this.renderCropSquare(), actions.cropWidescreen && this.renderCropWidescreen(), actions.cropWidescreenVertical && this.renderCropWidescreenVertical()));\n  };\n  return Editor;\n}(Component);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}