{"ast":null,"code":"import { h } from 'preact';\nimport classNames from 'classnames';\nimport statusBarStates from './StatusBarStates.js';\nimport calculateProcessingProgress from './calculateProcessingProgress.js';\nimport { UploadBtn, RetryBtn, CancelBtn, PauseResumeButton, DoneBtn, ProgressBarProcessing, ProgressBarError, ProgressBarUploading, ProgressBarComplete } from \"./Components.js\";\nconst STATE_ERROR = statusBarStates.STATE_ERROR,\n  STATE_WAITING = statusBarStates.STATE_WAITING,\n  STATE_PREPROCESSING = statusBarStates.STATE_PREPROCESSING,\n  STATE_UPLOADING = statusBarStates.STATE_UPLOADING,\n  STATE_POSTPROCESSING = statusBarStates.STATE_POSTPROCESSING,\n  STATE_COMPLETE = statusBarStates.STATE_COMPLETE; // TODO: rename the function to StatusBarUI on the next major.\n\nexport default function StatusBar(props) {\n  const newFiles = props.newFiles,\n    allowNewUpload = props.allowNewUpload,\n    isUploadInProgress = props.isUploadInProgress,\n    isAllPaused = props.isAllPaused,\n    resumableUploads = props.resumableUploads,\n    error = props.error,\n    hideUploadButton = props.hideUploadButton,\n    hidePauseResumeButton = props.hidePauseResumeButton,\n    hideCancelButton = props.hideCancelButton,\n    hideRetryButton = props.hideRetryButton,\n    recoveredState = props.recoveredState,\n    uploadState = props.uploadState,\n    totalProgress = props.totalProgress,\n    files = props.files,\n    supportsUploadProgress = props.supportsUploadProgress,\n    hideAfterFinish = props.hideAfterFinish,\n    isSomeGhost = props.isSomeGhost,\n    doneButtonHandler = props.doneButtonHandler,\n    isUploadStarted = props.isUploadStarted,\n    i18n = props.i18n,\n    startUpload = props.startUpload,\n    uppy = props.uppy,\n    isAllComplete = props.isAllComplete,\n    showProgressDetails = props.showProgressDetails,\n    numUploads = props.numUploads,\n    complete = props.complete,\n    totalSize = props.totalSize,\n    totalETA = props.totalETA,\n    totalUploadedSize = props.totalUploadedSize;\n  function getProgressValue() {\n    switch (uploadState) {\n      case STATE_POSTPROCESSING:\n      case STATE_PREPROCESSING:\n        {\n          const progress = calculateProcessingProgress(files);\n          if (progress.mode === 'determinate') {\n            return progress.value * 100;\n          }\n          return totalProgress;\n        }\n      case STATE_ERROR:\n        {\n          return null;\n        }\n      case STATE_UPLOADING:\n        {\n          if (!supportsUploadProgress) {\n            return null;\n          }\n          return totalProgress;\n        }\n      default:\n        return totalProgress;\n    }\n  }\n  function getIsIndeterminate() {\n    switch (uploadState) {\n      case STATE_POSTPROCESSING:\n      case STATE_PREPROCESSING:\n        {\n          const _calculateProcessingP = calculateProcessingProgress(files),\n            mode = _calculateProcessingP.mode;\n          return mode === 'indeterminate';\n        }\n      case STATE_UPLOADING:\n        {\n          if (!supportsUploadProgress) {\n            return true;\n          }\n          return false;\n        }\n      default:\n        return false;\n    }\n  }\n  function getIsHidden() {\n    if (recoveredState) {\n      return false;\n    }\n    switch (uploadState) {\n      case STATE_WAITING:\n        return hideUploadButton || newFiles === 0;\n      case STATE_COMPLETE:\n        return hideAfterFinish;\n      default:\n        return false;\n    }\n  }\n  const progressValue = getProgressValue();\n  const isHidden = getIsHidden();\n  const width = progressValue != null ? progressValue : 100;\n  const showUploadBtn = !error && newFiles && !isUploadInProgress && !isAllPaused && allowNewUpload && !hideUploadButton;\n  const showCancelBtn = !hideCancelButton && uploadState !== STATE_WAITING && uploadState !== STATE_COMPLETE;\n  const showPauseResumeBtn = resumableUploads && !hidePauseResumeButton && uploadState === STATE_UPLOADING;\n  const showRetryBtn = error && !isAllComplete && !hideRetryButton;\n  const showDoneBtn = doneButtonHandler && uploadState === STATE_COMPLETE;\n  const progressClassNames = classNames('uppy-StatusBar-progress', {\n    'is-indeterminate': getIsIndeterminate()\n  });\n  const statusBarClassNames = classNames('uppy-StatusBar', `is-${uploadState}`, {\n    'has-ghosts': isSomeGhost\n  });\n  return h(\"div\", {\n    className: statusBarClassNames,\n    \"aria-hidden\": isHidden\n  }, h(\"div\", {\n    className: progressClassNames,\n    style: {\n      width: `${width}%`\n    },\n    role: \"progressbar\",\n    \"aria-label\": `${width}%`,\n    \"aria-valuetext\": `${width}%`,\n    \"aria-valuemin\": \"0\",\n    \"aria-valuemax\": \"100\",\n    \"aria-valuenow\": progressValue\n  }), (() => {\n    switch (uploadState) {\n      case STATE_PREPROCESSING:\n      case STATE_POSTPROCESSING:\n        return h(ProgressBarProcessing, {\n          progress: calculateProcessingProgress(files)\n        });\n      case STATE_COMPLETE:\n        return h(ProgressBarComplete, {\n          i18n: i18n\n        });\n      case STATE_ERROR:\n        return h(ProgressBarError, {\n          error: error,\n          i18n: i18n,\n          numUploads: numUploads,\n          complete: complete\n        });\n      case STATE_UPLOADING:\n        return h(ProgressBarUploading, {\n          i18n: i18n,\n          supportsUploadProgress: supportsUploadProgress,\n          totalProgress: totalProgress,\n          showProgressDetails: showProgressDetails,\n          isUploadStarted: isUploadStarted,\n          isAllComplete: isAllComplete,\n          isAllPaused: isAllPaused,\n          newFiles: newFiles,\n          numUploads: numUploads,\n          complete: complete,\n          totalUploadedSize: totalUploadedSize,\n          totalSize: totalSize,\n          totalETA: totalETA,\n          startUpload: startUpload\n        });\n      default:\n        return null;\n    }\n  })(), h(\"div\", {\n    className: \"uppy-StatusBar-actions\"\n  }, recoveredState || showUploadBtn ? h(UploadBtn, {\n    newFiles: newFiles,\n    isUploadStarted: isUploadStarted,\n    recoveredState: recoveredState,\n    i18n: i18n,\n    isSomeGhost: isSomeGhost,\n    startUpload: startUpload,\n    uploadState: uploadState\n  }) : null, showRetryBtn ? h(RetryBtn, {\n    i18n: i18n,\n    uppy: uppy\n  }) : null, showPauseResumeBtn ? h(PauseResumeButton, {\n    isAllPaused: isAllPaused,\n    i18n: i18n,\n    isAllComplete: isAllComplete,\n    resumableUploads: resumableUploads,\n    uppy: uppy\n  }) : null, showCancelBtn ? h(CancelBtn, {\n    i18n: i18n,\n    uppy: uppy\n  }) : null, showDoneBtn ? h(DoneBtn, {\n    i18n: i18n,\n    doneButtonHandler: doneButtonHandler\n  }) : null));\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}