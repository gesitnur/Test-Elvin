{"ast":null,"code":"// import {\n//   Core,\n//   FileInput,\n//   Informer,\n//   ProgressBar,\n//   XHRUpload,\n// } from 'uppy'\n\n// document.addEventListener('DOMContentLoaded', () => {\n//   const fileInput = document.querySelector('#my-file-input')\n//   // console.log('-----a-------')\n//   // console.log(fileInput)\n//   // console.log('-----a-------')\n\n//   fileInput.addEventListener('change', (event) => {\n//     const files = Array.from(event.target.files)\n\n//     files.forEach((file) => {\n//       try {\n//         uppy.addFile({\n//           source: 'file input',\n//           name: file.name,\n//           type: file.type,\n//           data: file,\n//         })\n//       } catch (err) {\n//         if (err.isRestriction) {\n//           // handle restrictions\n//           console.log('Restriction error:', err)\n//         } else {\n//           // handle other errors\n//           console.error(err)\n//         }\n//       }\n//     console.log(uppy)\n//     uppy.on('thumbnail:generated', (file, preview) => {\n//       const img = document.createElement('img')\n//       img.src = preview\n//       img.width = 100\n//       document.body.appendChild(img)\n//     })\n//     })\n//   })\n// });\n\n// const uppy = Core({\n//   autoProceed: true,\n// })\n\nimport 'uppy/dist/uppy.min.css';\nimport { Core, FileInput, Informer, ProgressBar, XHRUpload } from 'uppy';\nfunction fileUpload(fileInput) {\n  var hiddenInput = document.querySelector('.upload-data'),\n    filePreview = document.querySelector('.file-preview'),\n    form = $(fileInput).parents('form'),\n    submitButton = document.getElementById('button-form-uppy'),\n    formGroup = fileInput.parentNode;\n  var attachment_url = window.location.origin + $('#attachment_url').data('url');\n  var authenticity_token = $('meta[name=\"csrf-token\"]').attr('content');\n  var compiledToken, compiledLink;\n  if (attachment_url.includes('?')) {\n    compiledToken = \"&authenticity_token=\".concat(authenticity_token);\n  } else {\n    compiledToken = \"?authenticity_token=\".concat(authenticity_token);\n  }\n  compiledLink = \"\".concat(attachment_url).concat(compiledToken);\n\n  // remove our file input in favour of Uppy's\n  // formGroup.removeChild(fileInput)\n\n  var uppy = Core({\n    autoProceed: true\n  }).use(FileInput, {\n    target: formGroup\n  }).use(Informer, {\n    target: formGroup\n  }).use(ProgressBar, {\n    target: filePreview.parentNode\n  }).use(XHRUpload, {\n    endpoint: compiledLink,\n    fieldName: 'files[]'\n  });\n  uppy.on('upload-success', function (file, response) {\n    $('.file-preview').append(response.body.files_previews);\n  });\n  uppy.on('upload-error', function (file, error, response) {\n    submitButton.removeAttribute(\"disabled\");\n    submitButton.innerHTML = \"Save\";\n  });\n}\nexport default fileUpload;","map":{"version":3,"names":["Core","FileInput","Informer","ProgressBar","XHRUpload","fileUpload","fileInput","hiddenInput","document","querySelector","filePreview","form","$","parents","submitButton","getElementById","formGroup","parentNode","attachment_url","window","location","origin","data","authenticity_token","attr","compiledToken","compiledLink","includes","uppy","autoProceed","use","target","endpoint","fieldName","on","file","response","append","body","files_previews","error","removeAttribute","innerHTML"],"sources":["/home/gesit/Documents/Project/elvin/app/javascript/packs/fileMultiUpload.js"],"sourcesContent":["// import {\n//   Core,\n//   FileInput,\n//   Informer,\n//   ProgressBar,\n//   XHRUpload,\n// } from 'uppy'\n\n// document.addEventListener('DOMContentLoaded', () => {\n//   const fileInput = document.querySelector('#my-file-input')\n//   // console.log('-----a-------')\n//   // console.log(fileInput)\n//   // console.log('-----a-------')\n\n//   fileInput.addEventListener('change', (event) => {\n//     const files = Array.from(event.target.files)\n\n//     files.forEach((file) => {\n//       try {\n//         uppy.addFile({\n//           source: 'file input',\n//           name: file.name,\n//           type: file.type,\n//           data: file,\n//         })\n//       } catch (err) {\n//         if (err.isRestriction) {\n//           // handle restrictions\n//           console.log('Restriction error:', err)\n//         } else {\n//           // handle other errors\n//           console.error(err)\n//         }\n//       }\n//     console.log(uppy)\n//     uppy.on('thumbnail:generated', (file, preview) => {\n//       const img = document.createElement('img')\n//       img.src = preview\n//       img.width = 100\n//       document.body.appendChild(img)\n//     })\n//     })\n//   })\n// });\n\n// const uppy = Core({\n//   autoProceed: true,\n// })\n\nimport 'uppy/dist/uppy.min.css'\n\nimport {\n  Core,\n  FileInput,\n  Informer,\n  ProgressBar,\n  XHRUpload,\n} from 'uppy'\n\nfunction fileUpload(fileInput) {\n  const hiddenInput = document.querySelector('.upload-data'),\n        filePreview = document.querySelector('.file-preview'),\n        form = $(fileInput).parents('form'),\n        submitButton = document.getElementById('button-form-uppy'),\n        formGroup = fileInput.parentNode;\n  var attachment_url    = window.location.origin + $('#attachment_url').data('url');\n\n  var authenticity_token = $('meta[name=\"csrf-token\"]').attr('content');\n  var compiledToken, compiledLink;\n\n  if (attachment_url.includes('?')) {\n    compiledToken = `&authenticity_token=${authenticity_token}`\n  } else {\n    compiledToken = `?authenticity_token=${authenticity_token}`\n  }\n\n  compiledLink = `${attachment_url}${compiledToken}`;\n\n  // remove our file input in favour of Uppy's\n  // formGroup.removeChild(fileInput)\n\n  const uppy = Core({\n      autoProceed: true,\n    })\n    .use(FileInput, {\n      target: formGroup,\n    })\n    .use(Informer, {\n      target: formGroup,\n    })\n    .use(ProgressBar, {\n      target: filePreview.parentNode,\n    })\n    .use(XHRUpload, {\n      endpoint: compiledLink,\n      fieldName: 'files[]',\n    })\n\n  uppy.on('upload-success', (file, response) => {\n    $('.file-preview').append(response.body.files_previews);\n  });\n\n  uppy.on('upload-error', (file, error, response) => {\n    submitButton.removeAttribute(\"disabled\")\n    submitButton.innerHTML = \"Save\"\n  })\n}\n\nexport default fileUpload\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO,wBAAwB;AAE/B,SACEA,IAAI,EACJC,SAAS,EACTC,QAAQ,EACRC,WAAW,EACXC,SAAS,QACJ,MAAM;AAEb,SAASC,UAAU,CAACC,SAAS,EAAE;EAC7B,IAAMC,WAAW,GAAGC,QAAQ,CAACC,aAAa,CAAC,cAAc,CAAC;IACpDC,WAAW,GAAGF,QAAQ,CAACC,aAAa,CAAC,eAAe,CAAC;IACrDE,IAAI,GAAGC,CAAC,CAACN,SAAS,CAAC,CAACO,OAAO,CAAC,MAAM,CAAC;IACnCC,YAAY,GAAGN,QAAQ,CAACO,cAAc,CAAC,kBAAkB,CAAC;IAC1DC,SAAS,GAAGV,SAAS,CAACW,UAAU;EACtC,IAAIC,cAAc,GAAMC,MAAM,CAACC,QAAQ,CAACC,MAAM,GAAGT,CAAC,CAAC,iBAAiB,CAAC,CAACU,IAAI,CAAC,KAAK,CAAC;EAEjF,IAAIC,kBAAkB,GAAGX,CAAC,CAAC,yBAAyB,CAAC,CAACY,IAAI,CAAC,SAAS,CAAC;EACrE,IAAIC,aAAa,EAAEC,YAAY;EAE/B,IAAIR,cAAc,CAACS,QAAQ,CAAC,GAAG,CAAC,EAAE;IAChCF,aAAa,iCAA0BF,kBAAkB,CAAE;EAC7D,CAAC,MAAM;IACLE,aAAa,iCAA0BF,kBAAkB,CAAE;EAC7D;EAEAG,YAAY,aAAMR,cAAc,SAAGO,aAAa,CAAE;;EAElD;EACA;;EAEA,IAAMG,IAAI,GAAG5B,IAAI,CAAC;IACd6B,WAAW,EAAE;EACf,CAAC,CAAC,CACDC,GAAG,CAAC7B,SAAS,EAAE;IACd8B,MAAM,EAAEf;EACV,CAAC,CAAC,CACDc,GAAG,CAAC5B,QAAQ,EAAE;IACb6B,MAAM,EAAEf;EACV,CAAC,CAAC,CACDc,GAAG,CAAC3B,WAAW,EAAE;IAChB4B,MAAM,EAAErB,WAAW,CAACO;EACtB,CAAC,CAAC,CACDa,GAAG,CAAC1B,SAAS,EAAE;IACd4B,QAAQ,EAAEN,YAAY;IACtBO,SAAS,EAAE;EACb,CAAC,CAAC;EAEJL,IAAI,CAACM,EAAE,CAAC,gBAAgB,EAAE,UAACC,IAAI,EAAEC,QAAQ,EAAK;IAC5CxB,CAAC,CAAC,eAAe,CAAC,CAACyB,MAAM,CAACD,QAAQ,CAACE,IAAI,CAACC,cAAc,CAAC;EACzD,CAAC,CAAC;EAEFX,IAAI,CAACM,EAAE,CAAC,cAAc,EAAE,UAACC,IAAI,EAAEK,KAAK,EAAEJ,QAAQ,EAAK;IACjDtB,YAAY,CAAC2B,eAAe,CAAC,UAAU,CAAC;IACxC3B,YAAY,CAAC4B,SAAS,GAAG,MAAM;EACjC,CAAC,CAAC;AACJ;AAEA,eAAerC,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}